import{f as v,I as A,a2 as O,J as p,E as f,a3 as j}from"./app.5957a2d0.js";const T=Symbol();class E{constructor(){this.events={},this.ymapReady=!1,this.scriptIsNotAttached=!0,this.pluginInstalledGlobal=!1}$on(a,n){return this.events[a]||(this.events[a]=[]),this.events[a].push(n),()=>{this.events[a]=this.events[a].filter(d=>n!==d)}}$emit(a){const n=this.events[a];n&&n.forEach(d=>d())}}const c=new E;function $(t){const a=n=>()=>{ymaps.ready(()=>{c.ymapReady=!0,c.$emit("scriptIsLoaded"),n(!0)})};return new Promise((n,d)=>{if(window.ymaps)return c.ymapReady||(c.ymapReady=!0,c.$emit("scriptIsLoaded")),n(!0);if(document.getElementById("vue-yandex-maps-script")){c.$on("scriptIsLoaded",n);return}const s=document.createElement("SCRIPT"),{apiKey:i="",lang:e="ru_RU",version:m="2.1",coordorder:l="latlong",debug:u=!1,enterprise:b=!1}=t,h=u?"debug":"release",o=`lang=${e}${i&&`&apikey=${i}`}&mode=${h}&coordorder=${l}`,r=`https://${b?"enterprise.":""}api-maps.yandex.ru/${m}/?${o}`;s.setAttribute("src",r),s.setAttribute("async",""),s.setAttribute("defer",""),s.setAttribute("id","vue-yandex-maps-script"),document.head.appendChild(s),c.scriptIsNotAttached=!1,s.onload=a(n),s.onerror=d})}const k=t=>Array.isArray(t)?t.map(k):+t,g=["actionbegin","actionbreak","actionend","actiontick","actiontickcomplete","balloonclose","balloonopen","boundschange","click","contextmenu","dblclick","destroy","hintclose","hintopen","marginchange","mousedown","mouseenter","mouseleave","mousemove","mouseup","multitouchend","multitouchmove","multitouchstart","optionschange","sizechange","typechange","wheel"],x=["balloonclose","balloonopen","beforedrag","beforedragstart","click","contextmenu","dblclick","drag","dragend","dragstart","editorstatechange","geometrychange","hintclose","hintopen","mapchange","mousedown","mouseenter","mouseleave","mousemove","mouseup","multitouchend","multitouchmove","multitouchstart","optionschange","overlaychange","parentchange","propertieschange","wheel"];function w(t,a=!1){let n=[],d=[],s,i;return{addGeoObject:(l,u)=>{n.push(a?u:l),clearTimeout(s),s=window.setTimeout(()=>{t(n,"add"),n=[]})},deleteGeoObject:(l,u)=>{d.push(a?u:l),clearTimeout(i),i=window.setTimeout(()=>{t(d,"remove"),d=[]})}}}var G=v({name:"YandexMap",props:{coordinates:{type:Array,required:!0},zoom:{type:Number,default:10},bounds:{type:Array,default:null},behaviors:{type:Array,default:null},controls:{type:Array,default:null},detailedControls:{type:Object,default:null},events:{type:Array,default:()=>["click"],validator:t=>t.every(a=>g.includes(a))},mapType:{type:String,default:"map"},settings:{type:Object,default:()=>({})},panOptions:{type:Object,default:void 0},options:{type:Object,default:()=>({})}},emits:[...g,"geo-objects-updated","created"],setup(t,{emit:a,slots:n,expose:d}){const s=A(!1),i=c.pluginInstalledGlobal&&O("pluginOptions")||{};let e;const m=`yandexMap${Math.round(Math.random()*1e5)}`,l=(o,r)=>{!e||!o.length||(o.forEach(y=>e==null?void 0:e.geoObjects[r](y)),a("geo-objects-updated",e.geoObjects))},{addGeoObject:u,deleteGeoObject:b}=w(l);j(T,{addGeoObject:u,deleteGeoObject:b});const h=()=>{s.value=!0,e=new ymaps.Map(m,{center:t.coordinates,zoom:t.zoom,bounds:t.bounds,behaviors:t.behaviors,controls:t.controls,type:`yandex#${t.mapType}`},t.options),t.events.forEach(o=>{var r;return(r=e==null?void 0:e.events)==null?void 0:r.add(o,y=>a(o,y))}),t.detailedControls&&Object.keys(t.detailedControls).forEach(r=>{var y;e==null||e.controls.remove(r),e==null||e.controls.add(r,(y=t.detailedControls)==null?void 0:y[r])}),a("created",e)};if(c.scriptIsNotAttached){const o={...i,...t.settings};$(o)}return c.ymapReady?ymaps.ready(h):c.$on("scriptIsLoaded",h),d(e),p(()=>t.coordinates,o=>e==null?void 0:e.panTo(o,t.panOptions)),p(()=>t.zoom,o=>e==null?void 0:e.setZoom(o)),p(()=>t.bounds,o=>e==null?void 0:e.setBounds(o)),p(()=>t.mapType,o=>e==null?void 0:e.setType(o)),()=>{var o;return f("section",{class:"yandex-container","data-test":"map"},[f("div",{id:m,style:"min-height: 100%;"}),s.value&&f("div",{style:"display: none;"},[(o=n.default)==null?void 0:o.call(n)])])}}});export{x as D,G as Y,T as a,k as c,w as u};
